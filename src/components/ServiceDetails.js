import React, { useState , useEffect, useRef } from "react";import {	View,	Text,	Image,	TouchableOpacity,	ImageBackground,	KeyboardAvoidingView,	I18nManager,	Dimensions,	FlatList,	Platform,	ActivityIndicator,	Linking, Share,} from "react-native";import {Container, Button, Form, Input, Toast, Header, Right, Left, Body, Icon, Content} from 'native-base'import styles from '../../assets/styles'import Swiper from 'react-native-swiper';import i18n from "../../locale/i18n";import StarRating from "react-native-star-rating";import COLORS from "../consts/colors";import { useDispatch, useSelector } from 'react-redux'import axios from "axios";import CONST from "../consts";const width	 		= Dimensions.get('window').width;const height 		= Dimensions.get('window').height;const isIOS  		= Platform.OS === 'ios';const IS_IPHONE_X 	= (height === 812 || height === 896) && Platform.OS === 'ios';const providers = [	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_1.jpg'), rate: 3, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_2.jpg'), rate: 5, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_3.jpg'), rate: 2, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_4.jpg'), rate: 4, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_3.jpg'), rate: 2, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_4.jpg'), rate: 4, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_3.jpg'), rate: 2, price: 500},	{id: 0, name: 'مؤسسة كشتة', category: 'سفاري', image: require('../../assets/images/prov_4.jpg'), rate: 4, price: 500},];function ServiceDetails({navigation, route}) {	const service_id = route.params.service_id;	const lang = useSelector(state => state.lang.lang);	const token = useSelector(state => state.auth.user ? state.auth.user.data.token : null);	const serviceDetailes = useSelector(state => state.serviceDetailes.serviceDetailes);	const serviceDetailesLoader = useSelector(state => state.serviceDetailes.loader);	const [screenLoader , setScreenLoader ] = useState(true);	const dispatch = useDispatch();	function fetchData(){		axios({			url         : CONST.url + 'serviceDetailes',			method      : 'POST',			data        : {lang , service_id},			headers     : {Authorization: token}		}).then(response => {			dispatch({type: 'getServiceDetailes', payload: response.data});			if(response.data.success){				setScreenLoader(false)			}		});	}	useEffect(() => {		fetchData();		const unsubscribe = navigation.addListener('focus', () => {			fetchData();		});		return unsubscribe;	}, [navigation , serviceDetailesLoader]);	function renderLoader(){		if (screenLoader){			return(				<View style={[styles.loading, styles.flexCenter, {height:'100%' , backgroundColor:'#fff'}]}>					<ActivityIndicator size="large" color={COLORS.babyblue} style={{ alignSelf: 'center' }} />				</View>			);		}	}	const onShare = async () => {		try {			const result = await Share.share({				message:					'Safari App',			});			if (result.action === Share.sharedAction) {				if (result.activityType) {					// shared with activity type of result.activityType				} else {					// shared				}			} else if (result.action === Share.dismissedAction) {				// dismissed			}		} catch (error) {			alert(error.message);		}	};	return (		<Container>			{renderLoader()}			<Content style={{ marginTop: IS_IPHONE_X ? -50 : 0 }}>				<View style={{ flexDirection: 'row', justifyCenter: 'space-between', position: 'absolute', width: '100%', height: 100, zIndex: 1, marginTop: IS_IPHONE_X ? 50 : 30 }}>					<TouchableOpacity style={{ left: 20 }} onPress={() => navigation.goBack()}>						<Image source={require('../../assets/images/white_back.png')} style={[ styles.transform, { width: 25, height: 25, marginTop: 10 }]} resizeMode={'contain'}/>					</TouchableOpacity>					<TouchableOpacity onPress={() => onShare()} style={{ position: 'absolute', right: 60}}>						<Image source={require('../../assets/images/share.png')} style={{ width: 25, height: 25, marginTop: 10 }} resizeMode={'contain'}/>					</TouchableOpacity>					<TouchableOpacity style={{ position: 'absolute', right: 20, marginTop: 5 }} >						<Icon type={'AntDesign'} name={'edit'} style={{ color: '#fff' }} />					</TouchableOpacity>				</View>				<View style={{ width: '100%', height: IS_IPHONE_X ? 400 : 330 }}>					<Swiper dotStyle={[styles.doteStyle2]}						activeDotStyle={[styles.activeDot2]}						key={3}						containerStyle={{ height: 300 }}						style={{ flexDirection: isIOS && I18nManager.isRTL  ? 'row' : 'row-reverse' }}						autoplay={true} loop={true}>						{							serviceDetailes.images.map((img, i) => (								<View key={i} style={{ }}>									<View style={[styles.overlay_black , styles.Width_100, { zIndex: 1, height: 400, position: 'absolute' }]} />									<Image source={{uri:img.image}} style={{ width: '100%', height: height*40/100, alignSelf: 'center' }} resizeMode={'cover'}/>								</View>							))						}					</Swiper>				</View>				<View style={{ width: '100%', height: 120, borderTopRightRadius: 40, backgroundColor: COLORS.blue, marginTop: -100, padding: 15 }}>					<View style={[styles.directionRowSpace]}>						<Text style={[styles.textBold, styles.textSize_18, styles.text_White, styles._alignText, styles.textRight]}>{serviceDetailes.name}</Text>						<Text style={[ styles.textSize_16, styles.text_White, styles.textRegular, styles._alignText]}>{serviceDetailes.price}</Text>					</View>				</View>				<View style={{ width: '100%', borderTopRightRadius: 50, backgroundColor: '#fff', marginTop: -45 , padding: 15, marginBottom: 50 }}>					<Text style={[ styles.textSize_14, styles.text_gray, styles.textRegular, styles.writngDir, styles.Width_100, { alignSelf: 'flex-start' } ]}>						{serviceDetailes.description}					</Text>					<View>						<Text style={[ styles.textSize_18, styles.text_black, styles.textBold, styles._alignText, { alignSelf: 'flex-start' } ]}> { i18n.t('additions') } </Text>						{							serviceDetailes.additions.map((adds, i) => (								<View style={{ backgroundColor: '#f7f7fa', flexDirection: 'row', borderRadius: 10, alignItems: 'center', padding: 5, marginVertical: 5 }}>							<View style={{ width: 60, height: 60, borderRadius: 10, overflow: 'hidden' }}>								<Image source={{uri:adds.image}} style={{ width: 60, height: 60 }} resizeMode={'contain'}/>							</View>							<View style={{ marginHorizontal: 10  }}>								<Text style={[ styles.textSize_14, styles.text_black, styles.textBold, styles._alignText, { alignSelf: 'flex-start' } ]}> {adds.addition} </Text>								<Text style={[ styles.textSize_14, styles.text_orange, styles.textRegular, styles._alignText, { alignSelf: 'flex-start', marginTop: -2 } ]}> {adds.price}</Text>							</View>						</View>							))						}					</View>				</View>			</Content>		</Container>	)}export default ServiceDetails;